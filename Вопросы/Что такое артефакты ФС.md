> [!Что такое артефакты ФС]
> Артефакты файловой системы — это остаточные данные или метаданные, которые остаются в системе после выполнения операций с файлами или директориями. Эти артефакты могут возникать при создании, изменении, удалении или перемещении файлов, а также при работе с файловой системой в целом. Они содержат информацию о том, какие действия были выполнены с файлами и когда.

В контексте Linux (и других UNIX-подобных систем), артефакты файловой системы могут быть полезны для администраторов, разработчиков или исследователей, занимающихся анализом безопасности, восстановлением данных или цифровой forensic (криминалистикой). 
## Часть 1. Основные типы артефактов
---
#### 1. Журналы файловой системы (Journal)
   1. Многие современные файловые системы (например, ext3, ext4, XFS, Btrfs) используют журналирование для обеспечения целостности данных при сбоях. Журнал хранит информацию о предстоящих изменениях в файловой системе до их фактического применения.
   2. Артефакты: 
	 - Записи в журнале могут содержать временные метки, имена файлов, размеры и другие детали о недавних операциях.
	 - После завершения операции записи журнал обычно очищается, но иногда можно найти остаточные данные.
#### 2. Информация из inode
   1. Каждый файл в Linux имеет связанный с ним inode (индексный узел), который содержит метаданные о файле, такие как:
     - Владелец файла
     - Разрешения
     - Размер
     - Время создания, модификации и последнего доступа (ctime, mtime, atime)
   2. Артефакты:
     - Даже если файл был удален, его inode может остаться в системе на некоторое время, пока не будет перезаписан новыми данными.
     - С помощью инструментов, таких как `debugfs`, можно извлечь информацию из inode.
#### 3. Свободное пространство (Unallocated Space)
   1. Когда файл удаляется, его содержимое не сразу стирается с диска. Вместо этого система помечает соответствующие блоки как "свободные", но данные могут сохраняться до тех пор, пока эти блоки не будут заняты новыми файлами.
   2. Артефакты:
     - Остаточные данные удаленных файлов могут быть восстановлены с помощью специальных инструментов, таких как `foremost`, `testdisk` или `scalpel`.
#### 4. Кэширование и буферизация
   1. Файловые системы и операционная система могут кэшировать данные для повышения производительности. Например:
     - Буферы страниц (*page cache*) хранят недавно использованные данные в оперативной памяти.
     - Системные журналы могут временно хранить информацию о файлах, даже если они уже удалены.
   2. Артефакты:
     - Информация из кэша может быть извлечена с помощью специализированных инструментов или анализа оперативной памяти.
#### 5. Директории и ссылки
   1. При удалении файла его имя может остаться в родительской директории до тех пор, пока система не обновит её структуру.
   2. Артефакты:
     - Использование команды `ls -i` может показать остаточные inode, указывающие на удаленные файлы.
     - Символические ссылки или жесткие ссылки могут указывать на файлы, которые физически удалены, но всё ещё существуют в системе.
#### 6. Логи системы
   1. Логи операционной системы (например, `/var/log`) могут содержать информацию о действиях с файлами, таких как:
     - Создание или удаление файлов
     - Изменение прав доступа
     - Перемещение файлов между директориями
   2. Артефакты:
     - Файлы логов (`syslog`, `auth.log`, `kern.log`) могут хранить временные метки и подробности о действиях пользователя.
#### 7. Файловые системы с версионированием
   1. Некоторые файловые системы, такие как Btrfs или ZFS, поддерживают снапшоты и версионирование данных.
   2. Артефакты:
     - Снапшоты могут содержать старые версии файлов, которые были изменены или удалены.
     - Это позволяет восстановить предыдущие состояния файловой системы.
#### 8. Теневые копии (Shadow Copies)
   1. Хотя это больше относится к Windows, некоторые Linux-системы могут использовать аналогичные механизмы (например, LVM сnapshot).
   2. Артефакты:
     - Теневые копии могут содержать данные, которые были удалены или изменены в основном хранилище.
## Часть 2. Пример анализа артефактов
---
Предположим, вы хотите проверить, какие файлы были недавно удалены:
1. Используйте `debugfs` для просмотра свободного пространства (эта команда покажет список удаленных inode):
   ```bash
   sudo debugfs -w /dev/sda1
   debugfs: lsdel
   ```
2. Попробуйте восстановить удаленные файлы с помощью `extundelete`:
   ```bash
   sudo extundelete /dev/sda1 --restore-all
   ```
3. Просмотрите логи системы:
   ```bash
   cat /var/log/syslog | grep "deleted"
   ```
## Заключение
---
Артефакты файловой системы — это важный источник информации для анализа действий пользователей, восстановления данных или расследования инцидентов. Однако важно понимать, что эти артефакты зависят от типа файловой системы, настроек системы и времени, прошедшего после операции.