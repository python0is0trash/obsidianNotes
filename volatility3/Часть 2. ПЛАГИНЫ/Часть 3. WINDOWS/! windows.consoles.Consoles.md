```bash
vol -f ../winDump.raw windows.consoles.Consoles
```
[[volatility3/Часть 2. ПЛАГИНЫ/Часть 3. WINDOWS/Специфические команды плагинов#windows.consoles.Consoles|Специфические команды плагинов]]

 Анализирует **зарегистрированные callback-функции в ядре** Windows. *Callback-функции* - это функции, которые регистрируются драйверами или компонентами ядра для выполнения определённых действий при наступлении конкретных событий (например, загрузка образа, создание потока или критическая ошибка системы).
## Пример вывода
___
```bash
Type                              Callback        Module         Symbol                                          Detail

PspLoadImageNotifyRoutine         0xf805218db110  WdFilter       -                                               N/A
KeBugCheckReasonCallbackListHead  0xf80526ab3480  WppRecorder    -                                               -
KeBugCheckReasonCallbackListHead  0xf80526ab3480  WppRecorder    -                                               -
GenericKernelCallback             0xf8052673b9a0  ksecdd         ??_C@_1M@HBMHBGAK@?$AAs?$AAv?$AA?9?$AAF?$AAI@   N/A
IoRegisterShutdownNotification    0xf805269aa710  Wdf01000       POP_ETW_EVENT_DYNAMIC_TICK_STATUS_RUNDOWN       \Driver\MpKsla4120a2e
```
## Что означает вывод
___
1. **Type:** Тип callback-функции. Указывает, для какого события зарегистрирована функция. 
```bash
Например:

PspLoadImageNotifyRoutine - Callback, вызываемый при загрузке образа (например, исполняемого файла или драйвера).
PspCreateThreadNotifyRoutine - Callback, вызываемый при создании нового потока.
KeBugCheckReasonCallbackListHead - Callback, вызываемый при возникновении критической ошибки (BSOD).
```
2. **Callback:** Адрес (виртуальный) callback-функции в памяти.
3. **Module:** Имя модуля (драйвера или компонента ядра), который зарегистрировал callback-функцию.
4. **Symbol:** Имя символа (функции), если оно доступно. Пустое поле (-), означает, что символ не был определён.
5. **Detail:** Дополнительная информация о callback-функции.
## Назначение вывода
---
1. **Подозрительные модули:** Если в списке присутствуют неизвестные модули (например, не связанные с легитимными драйверами или антивирусами), это может указывать на наличие руткитов или других вредоносных компонентов. Если такие модули обнаружены (например, `ahcache`), стоит изучить их подробнее с помощью таких плагинов, как [[! windows.modules.Modules]] или [[windows.driverscan.Driverscan]], чтобы получить больше информации.
2. **Необычные callback-функции:** Например, если callback-функция зарегистрирована для события, которое не связано с её назначением (например, драйвер принтера регистрирует callback для мониторинга потоков).
3. **Антивирусные callback-функции:** Легитимные антивирусы, такие как Microsoft Defender, регистрируют callback-функции для мониторинга системы. Их наличие обычно не вызывает подозрений.
4. **Дублирующиеся callback-функции:** Если одна и та же callback-функция зарегистрирована несколько раз, это может указывать на ошибку или подозрительную активность.
